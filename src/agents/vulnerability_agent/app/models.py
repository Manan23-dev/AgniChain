"""Data models for vulnerability agent."""
from datetime import datetime
from typing import List, Optional

from pydantic import BaseModel


class OSVVulnerability(BaseModel):
    """OSV vulnerability model."""
    id: str
    summary: Optional[str] = None
    severity: Optional[str] = None
    references: List[str] = []
    published: Optional[str] = None
    modified: Optional[str] = None


class EnrichedComponent(BaseModel):
    """Component with vulnerability data."""
    name: str
    version: str
    ecosystem: str
    purl: Optional[str] = None
    vulnerabilities: List[OSVVulnerability] = []


class CorrelationRecord(BaseModel):
    """Correlation record model."""
    pr_number: str
    commit_sha: str
    components: List[EnrichedComponent]
    created_at: datetime
    scan_doc_id: Optional[str] = None

